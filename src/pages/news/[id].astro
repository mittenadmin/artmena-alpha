---
import "../../styles/index.css";
import BaseLayout from "../../layouts/BaseLayout.astro";
import PageHero from "../../components/PageHero.astro";
import CardList from "../../components/Cards/CardList.astro";
import { newsArticles } from "../../data/news";
import { loadHtmlContent } from "../../utils/htmlContent";

export async function getStaticPaths() {
  return newsArticles.map((article) => ({
    params: { id: article.id },
    props: { article },
  }));
}

const { article } = Astro.props;

// Load HTML content if htmlFile is specified, otherwise use content property
const articleContent = article.htmlFile
  ? loadHtmlContent(article.htmlFile)
  : article.content;
---

<BaseLayout title={`artmena / ${article.title}`}>
  <div class="min-h-screen">
    <PageHero
      subtitle={article.category}
      title={article.title}
      largeText={true}
    />
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="flex flex-col">
        <img
          src={article.imageUrl}
          alt={article.title}
          class="w-full aspect-[5/3] object-cover"
          transition:name=`image-${article.id}`
        />
        <h3>{article.category}</h3>
        <h1>{article.title}</h1>
        <h3>By {article.author} Â· {article.date}</h3>
        <div
          class="border-t border-primary mt-4 article-content"
          set:html={articleContent}
        />
      </div>
    </div>
  </div>
</BaseLayout>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const navItems = document.querySelectorAll(".nav-item");
    const sections = document.querySelectorAll(".section-content");

    navItems.forEach((item) => {
      item.addEventListener("click", () => {
        const targetSection = (item as HTMLElement).dataset.section;

        // Remove active class from all nav items
        navItems.forEach((nav) => {
          nav.classList.remove("active");
          nav.classList.remove("border-primary");
          nav.classList.add("border-transparent");
        });

        // Add active class to clicked nav item
        item.classList.add("active");
        item.classList.add("border-primary");
        item.classList.remove("border-transparent");

        // Hide all sections
        sections.forEach((section) => {
          section.classList.add("hidden");
        });

        // Show the target section
        const targetElement = document.getElementById(
          `section-${targetSection}`,
        );
        if (targetElement) {
          targetElement.classList.remove("hidden");
        }
      });
    });
  });
</script>
